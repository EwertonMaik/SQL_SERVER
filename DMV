-- DMV - DYNAMIC MANAGEMENT VIEWS
-- Dividen-se em vários grupos de visualizações

ALWAYSON AVAILABILITY GROUP            SYS.DM_HADR_*
CHANGE DATA CAPTURE RELATED            SYS.DM_CDC_*
CHANGE TRACKING RELATED	               SYS.DM_TRAN_*
COMMON LANGUAGE RUNTIME RELATED        SYS.DM_CLR_*
DATABASE MIRRORING RELATED             SYS.DM_DB_MIRRORING_*
DATABASE RELATED DYNAMIC               SYS.DM_DB_*
EXECUTION RELATED DYNAMIC              SYS.DM_EXEC_*
EXTENDED EVENTS                        SYS.DM_XE_*
FILESTREAM AND FILETABLE(TRANSACT-SQL) SYS.DM_FILESTREAM_*
FULL-TEXT SEARCH AND SEMANTIC SEARCH   SYS.DM_FTS_*
I/O RELATED                            SYS.DM_IO_*
INDEX RELATED                          SYS.DM_DB_INDEX_*
OBJECT RELATED                         SYS.DM_SQL_*
QUERY NOTIFICATIONS RELATED            SYS.DM_QN_*
REPLICATION RELATED                    SYS.DM_REPL_*
RESOURCE GOVERNOR                      SYS.DM_RESOURCE_GOVERNOR_*
SECURITY RELATED                       SYS.DM_AUDIT_*/SYS.DM_CRYPTOGRAPHIC_*
SERVICE BROKER RELATED                 SYS.DM_BROKER_*
SQL SERVER OPERATING SYSTEM RELATED    SYS.DM_OS_*
TRANSACTION RELATED                    SYS.DM_TRAN_*


-- Querys a seguir usa a view ALL_OBJECTS para listar, contar e agrupar quantas DMV's seu ambiente possui
-- Listando todas DMV's
SELECT a.name, a.type_desc
FROM SYS.all_objects a
WHERE NAME LIKE ('dm%')
order by a.name;

--Lista o total de DMV's pelo tipo (VIEW e FUNCTION)
SELECT a.type_desc, COUNT(*) as QTD
FROM SYS.all_objects a
WHERE NAME LIKE ('dm%')
group by a.type_desc;

--Lista o total de DMV's por categoria
SELECT ISNULL(SUBSTRING(a.name,1,CHARINDEX('_',a.name,4)-1),'Total') MOME, COUNT(*) QTD
FROM SYS.all_objects a
WHERE NAME LIKE ('dm%')
group by SUBSTRING(a.name,1,CHARINDEX('_',a.name,4)-1) with rollup
order by 1 asc;
